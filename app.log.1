2025-11-05 19:03:02,937 - app - ERROR - Internal Server Error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-11-05 19:05:41,979 - app - ERROR - Exception on /profile/2fa/enable [POST]
Traceback (most recent call last):
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_restful/__init__.py", line 298, in error_router
    return original_handler(e)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/profile/routes.py", line 105, in enable_2fa
    plain_codes, hashed_codes_json = auth_service.generate_recovery_codes()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/auth/services.py", line 140, in generate_recovery_codes
    codes = [pyotp.random_base32(10) for _ in range(10)]
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/pyotp/__init__.py", line 18, in random_base32
    raise ValueError("Secrets should be at least 160 bits")
ValueError: Secrets should be at least 160 bits
2025-11-05 19:05:41,980 - app - ERROR - Internal Server Error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-11-05 19:09:16,247 - app - ERROR - Exception on /profile/2fa/enable [POST]
Traceback (most recent call last):
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_restful/__init__.py", line 298, in error_router
    return original_handler(e)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/profile/routes.py", line 105, in enable_2fa
    plain_codes, hashed_codes_json = auth_service.generate_recovery_codes()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/auth/services.py", line 140, in generate_recovery_codes
    def generate_recovery_codes(self):
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/pyotp/__init__.py", line 18, in random_base32
    raise ValueError("Secrets should be at least 160 bits")
ValueError: Secrets should be at least 160 bits
2025-11-05 19:09:16,248 - app - ERROR - Internal Server Error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-11-05 19:10:14,728 - app - ERROR - Exception on /profile/2fa/enable [POST]
Traceback (most recent call last):
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_restful/__init__.py", line 298, in error_router
    return original_handler(e)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/profile/routes.py", line 105, in enable_2fa
    plain_codes, hashed_codes_json = auth_service.generate_recovery_codes()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/auth/services.py", line 140, in generate_recovery_codes
    def generate_recovery_codes(self):
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/pyotp/__init__.py", line 18, in random_base32
    raise ValueError("Secrets should be at least 160 bits")
ValueError: Secrets should be at least 160 bits
2025-11-05 19:10:14,730 - app - ERROR - Internal Server Error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-11-05 19:14:06,178 - app - ERROR - Exception on /login/verify-2fa [POST]
Traceback (most recent call last):
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask_restful/__init__.py", line 298, in error_router
    return original_handler(e)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ariel/Prácticas EGC/proyecto/poke-hub/app/modules/auth/routes.py", line 100, in verify_2fa
    user = authentication_service.repository.get(user_id)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'UserRepository' object has no attribute 'get'
2025-11-05 19:14:06,180 - app - ERROR - Internal Server Error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
